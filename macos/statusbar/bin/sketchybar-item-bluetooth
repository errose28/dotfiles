#!/usr/bin/env sh

bt_json="$(system_profiler -json SPBluetoothDataType)"
bt_state="$(echo "$bt_json" | jq -r '.SPBluetoothDataType[0].controller_properties.controller_state')"

if [ "$bt_state" = 'attrib_on' ]; then
    # Bluetooth on.
    # TODO: Search jq -r '.SPBluetoothDataType[0].devices_list[] to determine if device connected, and what type.
    # icon=
    icon=
    icon_font_size=13
else
    # Bluetooth off.
    icon=
    icon_font_size=15
fi

NAME=bluetooth \
SCRIPT='sketchybar-item-bluetooth' \
UPDATE_FREQ=2 \
LABEL="" \
ICON_FONT_SIZE="$icon_font_size" \
ICON="$icon" \
sketchybar-add-item

