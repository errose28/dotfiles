#!/usr/bin/env sh

if [ "$1" ] && [ "$2" ]; then
    desktop_id="$(bspc query --desktops --desktop "$1")"
    new_name="$2"
elif [ "$1" ]; then
    desktop_id="$(bspc query --desktops --desktop .focused)"
    new_name="$1"
else
    desktop_id="$(bspc query --desktops --desktop .focused)"
    old_name="$(bspwm-get-desktop-name "$desktop_id")"
    new_name="$(echo "$old_name" | rofi -dmenu -theme new_workspace.rasi -p 'Rename desktop: ')"
fi

# New name will be empty if Rofi was exited with no selection.
if [ "$new_name" ]; then
    # Trim whitespace.
    new_name="$(bspwm-get-desktop-name "$new_name")"
    bspc desktop "$desktop_id" --rename "$new_name"
    bspwm-set-desktop-status "$desktop_id"
fi
